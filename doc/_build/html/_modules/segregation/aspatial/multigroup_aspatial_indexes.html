<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>segregation.aspatial.multigroup_aspatial_indexes &#8212; segregation v1.0.6 Manual</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pysal-styles.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/pysal_favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html">
          segregation</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../installation.html">Installation</a></li>
                <li><a href="../../../api.html">API</a></li>
                <li><a href="../../../references.html">References</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#installing-released-version">Installing released version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#installing-development-version">Installing development version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api.html#aspatial-indices">Aspatial Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api.html#spatial-indices">Spatial Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api.html#multigroup-indices">Multigroup Indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api.html#profile-wrappers">Profile Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api.html#inference-wrappers">Inference Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api.html#decomposition">Decomposition</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for segregation.aspatial.multigroup_aspatial_indexes</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Multigroup Aspatial based Segregation Metrics</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Renan X. Cortes &lt;renanc@ucr.edu&gt;, Sergio J. Rey &lt;sergio.rey@ucr.edu&gt; and Elijah Knaap &lt;elijah.knaap@ucr.edu&gt;&quot;</span>



<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="k">import</span> <span class="n">manhattan_distances</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Multi_Dissim&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Multi_Gini_Seg&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Multi_Normalized_Exposure&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Multi_Information_Theory&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Multi_Relative_Diversity&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Multi_Squared_Coefficient_of_Variation&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Multi_Diversity&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Simpsons_Concentration&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Simpsons_Interaction&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Multi_Divergence&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">_multi_dissim</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Dissimilarity index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Dissimilarity Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Sakoda, James M. &quot;A generalized index of dissimilarity.&quot; Demography 18.2 (1981): 245-250.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">ti</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pik</span> <span class="o">=</span> <span class="n">df</span><span class="o">/</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">Is</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pk</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">multi_D</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Is</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pik</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">K</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">multi_D</span><span class="p">,</span> <span class="n">core_data</span>


<div class="viewcode-block" id="Multi_Dissim"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Dissim.html#segregation.aspatial.Multi_Dissim">[docs]</a><span class="k">class</span> <span class="nc">Multi_Dissim</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Dissimilarity index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Dissimilarity Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Multi_Dissim</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Multi_Dissim(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.41340872573177806</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Sakoda, James M. &quot;A generalized index of dissimilarity.&quot; Demography 18.2 (1981): 245-250.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Multi_Dissim.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Dissim.html#segregation.aspatial.Multi_Dissim.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_multi_dissim</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_multi_dissim</span></div></div>
        
        
        
<span class="k">def</span> <span class="nf">_multi_gini_seg</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Gini Segregation index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Gini Segregation Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">K</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">ti</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pik</span> <span class="o">=</span> <span class="n">df</span><span class="o">/</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">Is</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pk</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">elements_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="n">ti</span><span class="p">),</span> <span class="n">manhattan_distances</span><span class="p">(</span><span class="n">pik</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">elements_sum</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
        
    <span class="n">multi_Gini_Seg</span> <span class="o">=</span> <span class="n">elements_sum</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Is</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">multi_Gini_Seg</span><span class="p">,</span> <span class="n">core_data</span>


<div class="viewcode-block" id="Multi_Gini_Seg"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Gini_Seg.html#segregation.aspatial.Multi_Gini_Seg">[docs]</a><span class="k">class</span> <span class="nc">Multi_Gini_Seg</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Gini Segregation index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Gini Segregation Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Multi_Gini_Seg</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Multi_Gini_Seg(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.5456349992598081</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Multi_Gini_Seg.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Gini_Seg.html#segregation.aspatial.Multi_Gini_Seg.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_multi_gini_seg</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_multi_gini_seg</span></div></div>
        


<span class="k">def</span> <span class="nf">_multi_normalized_exposure</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Normalized Exposure index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Normalized Exposure Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">ti</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pik</span> <span class="o">=</span> <span class="n">df</span><span class="o">/</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">MNE</span> <span class="o">=</span> <span class="p">((</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">pik</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">T</span>
    
    <span class="k">return</span> <span class="n">MNE</span><span class="p">,</span> <span class="n">core_data</span>


<div class="viewcode-block" id="Multi_Normalized_Exposure"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Normalized_Exposure.html#segregation.aspatial.Multi_Normalized_Exposure">[docs]</a><span class="k">class</span> <span class="nc">Multi_Normalized_Exposure</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Normalized Exposure index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Normalized Exposure Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Multi_Normalized_Exposure</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Multi_Normalized_Exposure(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.18821879029994157</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Multi_Normalized_Exposure.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Normalized_Exposure.html#segregation.aspatial.Multi_Normalized_Exposure.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_multi_normalized_exposure</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_multi_normalized_exposure</span></div></div>
        
        
        
<span class="k">def</span> <span class="nf">_multi_information_theory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Information Theory index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Information Theory Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">ti</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pik</span> <span class="o">=</span> <span class="n">df</span><span class="o">/</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="c1"># The natural logarithm is used, but this could be used with any base following Footnote 3 of pg. 37</span>
    <span class="c1"># of Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>
    <span class="n">E</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pk</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Pk</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">MIT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">pik</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pik</span> <span class="o">/</span> <span class="n">Pk</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">E</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">MIT</span><span class="p">,</span> <span class="n">core_data</span>


<div class="viewcode-block" id="Multi_Information_Theory"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Information_Theory.html#segregation.aspatial.Multi_Information_Theory">[docs]</a><span class="k">class</span> <span class="nc">Multi_Information_Theory</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Information Theory index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Information Theory Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Multi_Information_Theory</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Multi_Information_Theory(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.1710160297858887</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Multi_Information_Theory.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Information_Theory.html#segregation.aspatial.Multi_Information_Theory.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_multi_information_theory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_multi_information_theory</span></div></div>
        
        
        
<span class="k">def</span> <span class="nf">_multi_relative_diversity</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Relative Diversity index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Relative Diversity Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F. &quot;Measures of racial diversity and segregation in multigroup and hierarchically structured populations.&quot; annual meeting of the Eastern Sociological Society, Philadelphia, PA. 1998.</span>

<span class="sd">    High diversity means less segregation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">ti</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pik</span> <span class="o">=</span> <span class="n">df</span><span class="o">/</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">Is</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pk</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">MRD</span> <span class="o">=</span> <span class="p">(</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">pik</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">Is</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">MRD</span><span class="p">,</span> <span class="n">core_data</span>





<div class="viewcode-block" id="Multi_Relative_Diversity"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Relative_Diversity.html#segregation.aspatial.Multi_Relative_Diversity">[docs]</a><span class="k">class</span> <span class="nc">Multi_Relative_Diversity</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Relative Diversity index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Relative Diversity Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Multi_Relative_Diversity</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Multi_Relative_Diversity(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.15820019878220337</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F. &quot;Measures of racial diversity and segregation in multigroup and hierarchically structured populations.&quot; annual meeting of the Eastern Sociological Society, Philadelphia, PA. 1998.</span>

<span class="sd">    High diversity means less segregation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Multi_Relative_Diversity.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Relative_Diversity.html#segregation.aspatial.Multi_Relative_Diversity.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_multi_relative_diversity</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_multi_relative_diversity</span></div></div>
        
        
        
<span class="k">def</span> <span class="nf">_multi_squared_coefficient_of_variation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Squared Coefficient of Variation index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Squared Coefficient of Variation Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">K</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">ti</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pik</span> <span class="o">=</span> <span class="n">df</span><span class="o">/</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">C</span> <span class="o">=</span> <span class="p">((</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">pik</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pk</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">C</span><span class="p">,</span> <span class="n">core_data</span>




<div class="viewcode-block" id="Multi_Squared_Coefficient_of_Variation"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Squared_Coefficient_of_Variation.html#segregation.aspatial.Multi_Squared_Coefficient_of_Variation">[docs]</a><span class="k">class</span> <span class="nc">Multi_Squared_Coefficient_of_Variation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Squared Coefficient of Variation index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Squared Coefficient of Variation Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Multi_Squared_Coefficient_of_Variation</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Multi_Squared_Coefficient_of_Variation(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.11875484641127525</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Multi_Squared_Coefficient_of_Variation.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Squared_Coefficient_of_Variation.html#segregation.aspatial.Multi_Squared_Coefficient_of_Variation.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_multi_squared_coefficient_of_variation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_multi_squared_coefficient_of_variation</span></div></div>
        
        
<span class="k">def</span> <span class="nf">_multi_diversity</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">normalized</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Diversity index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic  : float</span>
<span class="sd">                 Multigroup Diversity Index</span>
<span class="sd">                </span>
<span class="sd">    core_data  : a pandas DataFrame</span>
<span class="sd">                 A pandas DataFrame that contains the columns used to perform the estimate.</span>
<span class="sd">                </span>
<span class="sd">    normalized : bool. Default is False.</span>
<span class="sd">                 Wheter the resulting index will be divided by its maximum (natural log of the number of groups)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67 and Theil, Henry. &quot;Statistical decomposition analysis; with applications in the social and administrative sciences&quot;. No. 04; HA33, T4.. 1972.</span>
<span class="sd">    </span>
<span class="sd">    This is also know as Theil&#39;s Entropy Index (Equation 2 of page 37 of Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67)</span>
<span class="sd">    </span>
<span class="sd">    High diversity means less segregation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">E</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">Pk</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Pk</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">E</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">E</span><span class="p">,</span> <span class="n">core_data</span>


<div class="viewcode-block" id="Multi_Diversity"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Diversity.html#segregation.aspatial.Multi_Diversity">[docs]</a><span class="k">class</span> <span class="nc">Multi_Diversity</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Diversity index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Diversity Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Multi_Diversity</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Multi_Diversity(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.9733112243997906</span>
<span class="sd">    </span>
<span class="sd">    You can also fit the normalized version of the multigroup diversity index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; normalized_index = Multi_Diversity(input_df, groups_list, normalized = True)</span>
<span class="sd">    &gt;&gt;&gt; normalized_index.statistic</span>
<span class="sd">    0.7020956383415715</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67 and Theil, Henry. &quot;Statistical decomposition analysis; with applications in the social and administrative sciences&quot;. No. 04; HA33, T4.. 1972.</span>
<span class="sd">    </span>
<span class="sd">    This is also know as Theil&#39;s Entropy Index (Equation 2 of page 37 of Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67)</span>
<span class="sd">    </span>
<span class="sd">    High diversity means less segregation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Multi_Diversity.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Diversity.html#segregation.aspatial.Multi_Diversity.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">normalized</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_multi_diversity</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">normalized</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_multi_diversity</span></div></div>
        
        

<span class="k">def</span> <span class="nf">_simpsons_concentration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Simpson&#39;s Concentration index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic  : float</span>
<span class="sd">                 Simpson&#39;s Concentration Index</span>
<span class="sd">                </span>
<span class="sd">    core_data  : a pandas DataFrame</span>
<span class="sd">                 A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Simpson, Edward H. &quot;Measurement of diversity.&quot; nature 163.4148 (1949): 688.</span>
<span class="sd">    </span>
<span class="sd">    Simpson&#39;s concentration index (Lambda) can be simply interpreted as the probability that two individuals chosen at random and independently from the population will be found to belong to the same group.</span>

<span class="sd">    Higher values means higher segregation.</span>
<span class="sd">    </span>
<span class="sd">    Simpson&#39;s Concentration + Simpson&#39;s Interaction = 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">Lambda</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pk</span> <span class="o">*</span> <span class="n">Pk</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">core_data</span>



<div class="viewcode-block" id="Simpsons_Concentration"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Simpsons_Concentration.html#segregation.aspatial.Simpsons_Concentration">[docs]</a><span class="k">class</span> <span class="nc">Simpsons_Concentration</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Simpson&#39;s Concentration index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic  : float</span>
<span class="sd">                 Simpson&#39;s Concentration Index</span>
<span class="sd">                </span>
<span class="sd">    core_data  : a pandas DataFrame</span>
<span class="sd">                 A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Simpsons_Concentration</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Simpsons_Concentration(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.49182413151957904</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Simpson, Edward H. &quot;Measurement of diversity.&quot; nature 163.4148 (1949): 688.</span>
<span class="sd">    </span>
<span class="sd">    Simpson&#39;s concentration index (Lambda) can be simply interpreted as the probability that two individuals chosen at random and independently from the population will be found to belong to the same group.</span>

<span class="sd">    Higher values means higher segregation.</span>
<span class="sd">    </span>
<span class="sd">    Simpson&#39;s Concentration + Simpson&#39;s Interaction = 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Simpsons_Concentration.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Simpsons_Concentration.html#segregation.aspatial.Simpsons_Concentration.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_simpsons_concentration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_simpsons_concentration</span></div></div>
        
        
        
<span class="k">def</span> <span class="nf">_simpsons_interaction</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Simpson&#39;s Interaction index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic  : float</span>
<span class="sd">                 Simpson&#39;s Interaction Index</span>
<span class="sd">                </span>
<span class="sd">    core_data  : a pandas DataFrame</span>
<span class="sd">                 A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Equation 1 of page 37 of Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>
<span class="sd">    </span>
<span class="sd">    Simpson&#39;s interaction index (I) can be simply interpreted as the probability that two individuals chosen at random and independently from the population will be found to not belong to the same group.</span>

<span class="sd">    Higher values means lesser segregation.</span>
<span class="sd">    </span>
<span class="sd">    Simpson&#39;s Concentration + Simpson&#39;s Interaction = 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pk</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Pk</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">I</span><span class="p">,</span> <span class="n">core_data</span>



<div class="viewcode-block" id="Simpsons_Interaction"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Simpsons_Interaction.html#segregation.aspatial.Simpsons_Interaction">[docs]</a><span class="k">class</span> <span class="nc">Simpsons_Interaction</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Simpson&#39;s Interaction index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic  : float</span>
<span class="sd">                 Simpson&#39;s Interaction Index</span>
<span class="sd">                </span>
<span class="sd">    core_data  : a pandas DataFrame</span>
<span class="sd">                 A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Simpsons_Interaction</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Simpsons_Interaction(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.508175868480421</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Equation 1 of page 37 of Reardon, Sean F., and Glenn Firebaugh. &quot;Measures of multigroup segregation.&quot; Sociological methodology 32.1 (2002): 33-67.</span>
<span class="sd">    </span>
<span class="sd">    Simpson&#39;s interaction index (I) can be simply interpreted as the probability that two individuals chosen at random and independently from the population will be found to not belong to the same group.</span>

<span class="sd">    Higher values means lesser segregation.</span>
<span class="sd">    </span>
<span class="sd">    Simpson&#39;s Concentration + Simpson&#39;s Interaction = 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Simpsons_Interaction.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Simpsons_Interaction.html#segregation.aspatial.Simpsons_Interaction.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_simpsons_interaction</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_simpsons_interaction</span></div></div>
        
        
        
<span class="k">def</span> <span class="nf">_multi_divergence</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Divergence index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Divergence Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Roberto, Elizabeth. &quot;The Divergence Index: A Decomposable Measure of Segregation and Inequality.&quot; arXiv preprint arXiv:1508.01167 (2015).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">core_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">groups</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">core_data</span><span class="p">)</span>
    
    <span class="n">T</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">ti</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pik</span> <span class="o">=</span> <span class="n">df</span><span class="o">/</span><span class="n">ti</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">Pk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="n">Di</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">pik</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pik</span> <span class="o">/</span> <span class="n">Pk</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">Divergence_Index</span> <span class="o">=</span> <span class="p">((</span><span class="n">ti</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">Di</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">Divergence_Index</span><span class="p">,</span> <span class="n">core_data</span>


<div class="viewcode-block" id="Multi_Divergence"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Divergence.html#segregation.aspatial.Multi_Divergence">[docs]</a><span class="k">class</span> <span class="nc">Multi_Divergence</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Multigroup Divergence index</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    data   : a pandas DataFrame</span>
<span class="sd">    </span>
<span class="sd">    groups : list of strings.</span>
<span class="sd">             The variables names in data of the groups of interest of the analysis.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    statistic : float</span>
<span class="sd">                Multigroup Divergence Index</span>
<span class="sd">                </span>
<span class="sd">    core_data : a pandas DataFrame</span>
<span class="sd">                A pandas DataFrame that contains the columns used to perform the estimate.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    In this example, we are going to use 2000 Census Tract Data for Sacramento MSA, CA. The groups of interest are White, Black, Asian and Hispanic population.</span>
<span class="sd">    </span>
<span class="sd">    Firstly, we need to perform some import the modules and the respective function.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import libpysal</span>
<span class="sd">    &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">    &gt;&gt;&gt; from segregation.multigroup_aspatial import Multi_Divergence</span>
<span class="sd">    </span>
<span class="sd">    Then, we read the data and create an auxiliary list with only the necessary columns for fitting the index.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; input_df = gpd.read_file(libpysal.examples.get_path(&quot;sacramentot2.shp&quot;))</span>
<span class="sd">    &gt;&gt;&gt; groups_list = [&#39;WHITE_&#39;, &#39;BLACK_&#39;, &#39;ASIAN_&#39;,&#39;HISP_&#39;]</span>
<span class="sd">    </span>
<span class="sd">    The value is estimated below.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; index = Multi_Divergence(input_df, groups_list)</span>
<span class="sd">    &gt;&gt;&gt; index.statistic</span>
<span class="sd">    0.16645182134289443</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Based on Roberto, Elizabeth. &quot;The Divergence Index: A Decomposable Measure of Segregation and Inequality.&quot; arXiv preprint arXiv:1508.01167 (2015).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Multi_Divergence.__init__"><a class="viewcode-back" href="../../../generated/segregation.aspatial.Multi_Divergence.html#segregation.aspatial.Multi_Divergence.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        
        <span class="n">aux</span> <span class="o">=</span> <span class="n">_multi_divergence</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statistic</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_data</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">_multi_divergence</span></div></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2018, pysal developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>